(window.webpackJsonpwebapp=window.webpackJsonpwebapp||[]).push([[0],{22:function(e,t,a){e.exports=a(54)},27:function(e,t,a){},54:function(e,t,a){"use strict";a.r(t);var n=a(0),s=a.n(n),r=a(18),l=a.n(r),i=(a(27),a(1)),c=a(2),o=a(4),u=a(3),d=a(5),p={add:"Add","add-application":"Add application",applications:"Applications",board:"Board",boards:"Boards",build:"Let's go!","build-in-progress":"Build in progress","choose-applications":"Choose the Pre-installed Applications","choose-applications-desc":"Select the applications that will be pre-installed on the device. For Ubuntu Core this will be snaps, for Ubuntu Classic it will be snaps or packages.","choose-board":"Choose Board","choose-board-desc":"Select the board for your device.","choose-os":"Choose the Operating System","choose-os-desc":"Select the version of Ubuntu to install on the device.",classic:"Classic",confirm:"Confirm","confirm-configuration":"Confirm board configuration",copyright:"\xa9 2019 Canonical Ltd. Ubuntu and Canonical are registered trademarks of Canonical Ltd.",core:"Core",downloads:"Downloads","find-snaps":"Find snaps to install","get-started":"Get started",home:"Home",legal:"Legal information",os:"Operating System","pre-installed-snaps":"Pre-installed snaps",privacy:"Data privacy","ready-to-build":"Ready to build the Ubuntu image?",remove:"X","remove-application":"Remove application","report-a-bug":"Report a bug on this site","select-board":"Select board","select-version":"Select version","site-description1":"Choose your board","site-description2":"Select the Operating System","site-description3":"Pick your pre-installed applications","search-store":"Enter snap name",snap:"snap","snap-name":"Snap name",snaps:"snaps","snap-store":"Snap Store",subtitle:"Image building service for IoT devices.",title:"Ubuntu Image Builder"};function m(e){return p[e]||e}function h(){var e=localStorage.getItem("board");return JSON.parse(e)}var b=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{id:"footer"},s.a.createElement("div",{className:"row footer"},s.a.createElement("p",null,m("copyright")),s.a.createElement("nav",{className:"p-footer__nav",role:"navigation"},s.a.createElement("ul",{className:"p-footer__links"},s.a.createElement("li",{className:"p-footer__item"},s.a.createElement("a",{className:"p-footer__link",href:"https://ubuntu.com/legal"},m("legal"))),s.a.createElement("li",{className:"p-footer__item"},s.a.createElement("a",{className:"p-footer__link",href:"https://ubuntu.com/legal/data-privacy"},m("privacy"))),s.a.createElement("li",{className:"p-footer__item"},s.a.createElement("a",{className:"p-footer__link",href:"https://github.com/CanonicalLtd/imagebuild/issues/new"},m("report-a-bug")))))))}}]),t}(n.Component),f=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("header",{id:"navigation",class:"p-navigation header-slim"},s.a.createElement("div",{className:"p-navigation__banner row"},s.a.createElement("div",{className:"p-navigation__logo"},s.a.createElement("div",{className:"u-vertically-center"},s.a.createElement("img",{src:"/static/images/logo.png",width:"150px"})))))}}]),t}(n.Component),g=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",null,s.a.createElement(f,null),s.a.createElement("section",{className:"p-strip--image is-dark header"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"col-5 title"},s.a.createElement("h1",null,m("title")),s.a.createElement("p",null,m("subtitle"))))))}}]),t}(n.Component),v=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={token:e.token||{}},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){return s.a.createElement("div",{className:"row"},s.a.createElement("section",{className:"row"},s.a.createElement("div",{className:"row"},s.a.createElement("div",{className:"first"},s.a.createElement("h2",null,m("get-started")),s.a.createElement("ul",{className:"p-list"},s.a.createElement("li",{className:"p-list__item is-ticked"},m("site-description1")),s.a.createElement("li",{className:"p-list__item is-ticked"},m("site-description2")),s.a.createElement("li",{className:"p-list__item is-ticked"},m("site-description3"))),s.a.createElement("p",null,m("build")),s.a.createElement("a",{className:"p-button--brand",href:"/boards",alt:""},m("choose-board"))))))}}]),t}(n.Component),E=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderBoards",value:function(){if(this.props.boards)return this.props.boards.map(function(e){return s.a.createElement("div",{className:"p-card board"},s.a.createElement("div",{className:"p-card__title"},s.a.createElement("img",{src:"/static/images/"+e.id+".png"})),s.a.createElement("div",{className:"p-card__content"},s.a.createElement("hr",null),s.a.createElement("h4",null,e.name),s.a.createElement("a",{href:"/boards/"+e.id,className:"p-button--neutral is-inline"},m("select-board"))))})}},{key:"render",value:function(){return s.a.createElement("div",{className:"first"},s.a.createElement("h2",null,m("choose-board")),s.a.createElement("p",null,m("choose-board-desc")),this.renderBoards())}}]),t}(n.Component),N=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderOS",value:function(){var e=this;return this.props.board.os.map(function(t){var a=t.type+t.version;return s.a.createElement("div",{className:"p-card os",key:a,onClick:e.handleClick},s.a.createElement("h3",{className:"u-vertically-center"},m(t.type)," ",m(t.version)),s.a.createElement("a",{href:"/boards/"+e.props.board.id+"/"+a,className:"p-button--neutral is-inline"},m("select-version")))})}},{key:"render",value:function(){return s.a.createElement("div",{className:"first"},s.a.createElement("h2",null,m("choose-os")),s.a.createElement("p",null,m("choose-os-desc")),s.a.createElement("div",{className:"summary"},s.a.createElement("p",null,s.a.createElement("i",{className:"p-icon--success"}),this.props.board.name)),this.renderOS())}}]),t}(n.Component),y=a(7),k=a.n(y),S="/v1/";var O={baseUrl:window.location.protocol+"//"+window.location.hostname+":"+window.location.port+S,LoadingImage:"/static/images/ajax-loader.gif",missingIcon:"/static/images/snapcraft-missing-icon.svg"},C={boardsList:function(e,t){return k.a.get(O.baseUrl+"boards")},buildRequest:function(e,t){return k.a.post(O.baseUrl+"build",e)},buildFetch:function(e,t){return k.a.post(O.baseUrl+"build/fetch",e)},storeSearch:function(e,t,a){return k.a.post(O.baseUrl+"store/snaps/"+e,t)}},w=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).pageUp=function(){var e=a.calculatePages(),t=a.props.page+1;t>e&&(t=e),a.signalPageChange(t)},a.pageDown=function(){var e=a.props.page-1;e<=0&&(e=1),a.signalPageChange(e)},a.pageSet=function(e){var t=parseInt(e.target.getAttribute("data-key"));a.setState({page:t}),a.signalPageChange(t)},a.state={query:null,maxRecords:10|e.pageSize},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"signalPageChange",value:function(e){var t=(e-1)*this.state.maxRecords;this.props.pageChange(e,t,t+this.state.maxRecords)}},{key:"calculatePages",value:function(){var e=this.props.displayRows.length,t=parseInt(e/this.state.maxRecords,10);return e%this.state.maxRecords>0&&(t+=1),t}},{key:"renderPaging",value:function(){var e=this.calculatePages(),t=parseInt((this.props.page-.1)/3);return e>1?s.a.createElement("div",{className:"u-float--right spacer"},s.a.createElement("button",{className:"p-button--neutral small",onClick:this.pageDown,disabled:1===this.props.page?"disabled":""},"\u2039"),s.a.createElement("button",{className:3*t+1===this.props.page?"p-button--neutral small active":"p-button--neutral small",onClick:this.pageSet,"data-key":3*t+1},3*t+1),3*t+2<=e?s.a.createElement("button",{className:3*t+2===this.props.page?"p-button--neutral small active":"p-button--neutral small",onClick:this.pageSet,"data-key":3*t+2},3*t+2):"",3*t+3<=e?s.a.createElement("button",{className:3*t+3===this.props.page?"p-button--neutral small active":"p-button--neutral small",onClick:this.pageSet,"data-key":3*t+3},3*t+3):"",s.a.createElement("button",{className:"p-button--neutral small",href:"",onClick:this.pageUp,disabled:this.props.page===e?"disabled":""},"\u203a")):s.a.createElement("div",{className:"u-float--right"})}},{key:"render",value:function(){return s.a.createElement("div",{className:"col-12 pagination u-align--center"},this.renderPaging())}}]),t}(n.Component),_=a(19),j=a.n(_),I=10,R=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleClear=function(e){a.setState({snaps:[],currentSearch:""})},a.handleSearchChange=function(e){e.preventDefault(),a.setState({snapName:e.target.value})},a.handleKeyPress=function(e){"Enter"===e.key&&(e.stopPropagation(),a.searchStore())},a.handleSearchStore=function(e){e.preventDefault(),a.searchStore()},a.handleInstall=function(e){e.preventDefault();var t=e.target.getAttribute("data-key");a.props.handleInstallClick(t)},a.handleRecordsForPage=function(e,t,n){a.setState({page:e,startRow:t,endRow:n})},a.state={currentSearch:"",snapName:"",snaps:[],loadingSearch:!1,page:1,startRow:0,endRow:I},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"searchStore",value:function(){var e=this;if(0!==this.state.snapName.length){var t={boardId:this.props.board.id,osId:this.props.os.id};this.setState({loadingSearch:!0}),C.storeSearch(this.state.snapName,t).then(function(t){t.data._embedded&&t.data._embedded["clickindex:package"]&&e.setState({snaps:t.data._embedded["clickindex:package"],loadingSearch:!1,message:null,messageType:null,currentSearch:e.state.snapName,page:1,startRow:0,endRow:I})})}else this.setState({currentSearch:""})}},{key:"renderSnaps",value:function(e){var t=this;return e.length>0?s.a.createElement("div",null,s.a.createElement("p",null,e.length," snaps found"),s.a.createElement("table",{className:"store"},s.a.createElement("thead",null,s.a.createElement("tr",null,s.a.createElement("th",null,m("snap-name")))),s.a.createElement("tbody",null,e.slice(this.state.startRow,this.state.endRow).map(function(e){return s.a.createElement("tr",{key:e.snap_id,title:e.description},s.a.createElement("td",{className:"overflow"},s.a.createElement("img",{src:e.icon_url||O.missingIcon,width:"30px"}),s.a.createElement("button",{"data-key":e.package_name,className:"p-button--neutral small",title:m("add-application"),onClick:t.handleInstall},m("add")),s.a.createElement("b",null,e.package_name)," ",e.version,s.a.createElement("br",null),e.developer_name," (",j()(e.binary_filesize),")"))})))):this.state.currentSearch.length>0?s.a.createElement("div",null,"No snaps found."):void 0}},{key:"render",value:function(){var e=this.state.snaps;return this.props.message?s.a.createElement("div",{className:"col-6 snaps"},s.a.createElement("h4",null,this.state.loadingSearch?s.a.createElement("img",{src:O.LoadingImage,alt:m("loading")}):"",this.props.message),s.a.createElement("p",null,s.a.createElement("form",{className:"p-search-box"},s.a.createElement("input",{className:"p-search-box__input",type:"search",name:"snapname",onKeyPress:this.handleKeyPress,onChange:this.handleSearchChange,placeholder:m("search-store")}),s.a.createElement("button",{type:"reset",className:"p-search-box__reset",alt:"reset",disabled:"",onClick:this.handleClear},s.a.createElement("i",{className:"p-icon--close"})),s.a.createElement("button",{type:"submit",onClick:this.handleSearchStore,className:"p-search-box__button",alt:"search"},s.a.createElement("i",{className:"p-icon--search"})))),this.renderSnaps(e),s.a.createElement(w,{displayRows:e,pageSize:I,page:this.state.page,pageChange:this.handleRecordsForPage})):s.a.createElement("span",null)}}]),t}(n.Component),x=function(e){function t(e){var a;Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).handleSnapInstall=function(e){if(!(a.state.snaps.indexOf(e)>=0)){var t=a.state.snaps;t.push(e),a.setState({snaps:t})}},a.handleSnapOnChange=function(e){e.preventDefault(),a.setState({snapName:e.target.value})},a.handleDialogCancel=function(e){e.preventDefault()},a.handleRemove=function(e){e.preventDefault();var t=e.target.getAttribute("data-key"),n=a.state.snaps.filter(function(e){return e!==t});a.setState({snaps:n})},a.handleConfirm=function(e){e.preventDefault(),function(e){var t=JSON.stringify(e);localStorage.setItem("board",t)}({board:a.props.board,os:a.props.os,snaps:a.state.snaps}),window.location.href="/confirm"},a.state={snaps:[]};var n=h();return n&&n.snaps&&n.snaps.length>0&&(a.state.snaps=n.snaps),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"renderSelected",value:function(){return s.a.createElement("div",{className:"row summary"},s.a.createElement("p",null,s.a.createElement("i",{className:"p-icon--success"}),this.props.board.name),s.a.createElement("p",null,s.a.createElement("i",{className:"p-icon--success"}),"Ubuntu ",m(this.props.os.type)," ",this.props.os.version))}},{key:"render",value:function(){var e=this;return s.a.createElement("div",{className:"first"},s.a.createElement("h2",null,m("choose-applications")),s.a.createElement("p",null,m("choose-applications-desc")),this.renderSelected(),s.a.createElement("div",{className:"row"},s.a.createElement(R,{message:m("find-snaps"),board:this.props.board,os:this.props.os,handleTextChange:this.handleSnapOnChange,handleInstallClick:this.handleSnapInstall,handleCancelClick:this.handleDialogCancel}),s.a.createElement("div",{className:"col-4"},s.a.createElement("p",{className:"p-muted-heading"},m("pre-installed-snaps")),s.a.createElement("hr",{className:"lean"}),s.a.createElement("ul",{className:"p-list"},this.state.snaps.map(function(t){return s.a.createElement("li",{className:"p-list__item hover"},t," \xa0",s.a.createElement("button",{"data-key":t,className:"p-button--neutral small hover__hover",title:m("remove-application"),onClick:e.handleRemove},m("remove")))})))),s.a.createElement("div",null,s.a.createElement("button",{className:"p-button--brand",onClick:this.handleConfirm,disabled:0===this.state.snaps.length?"disabled":""},m("confirm"))))}}]),t}(n.Component),U=a(8),B=a(20),P=a.n(B),D=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).poll=function(){setTimeout(a.getBuildStatus.bind(Object(U.a)(a)),1e4)},a.handleBuild=function(e){var t=a.props.board,n={boardId:t.board.id,osId:t.os.id,snaps:t.snaps};C.buildRequest(n).then(function(e){a.setState({buildURL:e.data.buildURL,building:!0})}).then(function(){a.getBuildStatus()})},a.state={messages:[],buildURL:"",downloads:[],building:!1},a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getBuildStatus",value:function(){var e=this,t={link:this.state.buildURL},a={};C.buildFetch(t).then(function(t){var n="Build started: "+(a=t.data.build).date_started;a.date_started&&(n=n+" ("+P()(a.date_started).fromNow()+")");var s=[n];s.push("Status: "+a.buildstate),s.push("Type: "+a.title),s.push("Log: "+a.build_log_url),e.setState({messages:s,downloads:a.downloads})}).then(function(){"Successfully built"!==a.buildstate&&"Failed to build"!==a.buildstate?e.poll():e.setState({building:!1})})}},{key:"renderSelected",value:function(){return s.a.createElement("div",{className:"row summary"},s.a.createElement("p",null,s.a.createElement("i",{className:"p-icon--success"}),this.props.board.board.name),s.a.createElement("p",null,s.a.createElement("i",{className:"p-icon--success"}),"Ubuntu ",m(this.props.board.os.type)," ",this.props.board.os.version),s.a.createElement("p",null,s.a.createElement("i",{className:"p-icon--success"}),1!==this.props.board.snaps.length?this.props.board.snaps.length+" "+m("snaps"):"1 "+m("snap")))}},{key:"renderConsole",value:function(){if(0!==this.state.messages.length)return s.a.createElement("pre",{className:"console"},this.state.messages.map(function(e){return e+"\n"}))}},{key:"renderDownloads",value:function(){if(this.state.downloads&&0!==this.state.downloads.length)return s.a.createElement("div",{className:"row"},s.a.createElement("h2",null,m("downloads")),this.state.downloads.map(function(e){var t=e.split("/"),a=t[t.length-1];console.log("---",a);var n=a.split(".");if("xz"===n[n.length-1])return s.a.createElement("p",null,s.a.createElement("a",{href:e},a))}))}},{key:"renderMessage",value:function(){return this.state.building?s.a.createElement("div",null,s.a.createElement("img",{src:"/static/images/ajax-loader.gif"})," ",m("build-in-progress")):s.a.createElement("div",null,m("ready-to-build")," \xa0",s.a.createElement("button",{className:"p-button--brand",onClick:this.handleBuild,disabled:this.state.building},m("build")))}},{key:"render",value:function(){var e=this.props.board;return s.a.createElement("div",{className:"first"},s.a.createElement("h2",null,m("confirm-configuration")),this.renderSelected(),s.a.createElement("div",{className:"row"},s.a.createElement("pre",null,s.a.createElement("code",null,"board:","\n","  name: ",e.board.name,"\n","  os:","\n","    type: ",e.os.type,"\n","    version: ",e.os.version,"\n","  snaps:","\n",e.snaps.map(function(e){return"    "+e+"\n"})))),this.renderMessage(),s.a.createElement("div",{className:"row"},this.renderConsole()),this.renderDownloads())}}]),t}(n.Component),L=a(21),A=a.n(L),F=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(c.a)(t,[{key:"render",value:function(){var e=this.props.route,t="boards"!==e.section||e.sectionId?"":"active",a="boards"===e.section&&e.sectionId&&!e.subsection?"active":"",n="boards"===e.section&&e.sectionId&&e.subsection?"active":"";if("confirm"===e.section){var r=h();e.section="boards",e.sectionId=r.board.id,e.subsection=r.os.type+r.os.version,e.subsubsection="confirm"}return s.a.createElement("div",{className:"breadcrumbs"},s.a.createElement("div",{className:"row"},s.a.createElement("ul",{className:"p-breadcrumbs"},s.a.createElement("li",{className:"p-breadcrumbs__item"},s.a.createElement("a",{href:"/"},m("home"))),s.a.createElement("li",{className:"p-breadcrumbs__item "+t},s.a.createElement("a",{href:"/boards"},m("boards"))),a||n||e.subsubsection?s.a.createElement("li",{className:"p-breadcrumbs__item "+a},s.a.createElement("a",{href:"/"+e.section+"/"+e.sectionId},m("os"))):"",n||e.subsubsection?s.a.createElement("li",{className:"p-breadcrumbs__item "+n},s.a.createElement("a",{href:"/"+e.section+"/"+e.sectionId+"/"+e.subsection},m("applications"))):"",e.subsubsection?s.a.createElement("li",{className:"p-breadcrumbs__item active"},s.a.createElement("a",{href:"/confirm"},m("confirm"))):"")))}}]),t}(n.Component),T=A()(),z=function(e){function t(e){var a;return Object(i.a)(this,t),(a=Object(o.a)(this,Object(u.a)(t).call(this,e))).state={location:T.location,token:e.token||{},boards:[]},a.getBoards(),a}return Object(d.a)(t,e),Object(c.a)(t,[{key:"getBoards",value:function(){var e=this;C.boardsList().then(function(t){e.setState({boards:t.data.boards})})}},{key:"renderBoards",value:function(e,t){if(!e)return s.a.createElement(E,{boards:this.state.boards});var a=this.state.boards.filter(function(t){return t.id===e});if(0!==a.length){if(!t)return s.a.createElement(N,{board:a[0]});var n=a[0].os.filter(function(e){return e.id===t});if(0!==n.length)return s.a.createElement(x,{board:a[0],os:n[0]})}}},{key:"renderConfirm",value:function(e,t){var a=h();return s.a.createElement(D,{board:a})}},{key:"render",value:function(){var e=function(){var e=window.location.pathname.split("/");switch(e.length){case 2:return{section:e[1]};case 3:return{section:e[1],sectionId:e[2]};case 4:return{section:e[1],sectionId:e[2],subsection:e[3]};default:return{}}}();return console.log(e),s.a.createElement("div",{className:"App"},""===e.section?s.a.createElement(g,null):"",""!==e.section?s.a.createElement(f,null):"",""!==e.section?s.a.createElement(F,{route:e}):"",s.a.createElement("div",{className:"content row"},""===e.section?s.a.createElement(v,null):"","boards"===e.section?this.renderBoards(e.sectionId,e.subsection):"","confirm"===e.section?this.renderConfirm(e.sectionId,e.subsection):""),s.a.createElement(b,null))}}]),t}(n.Component);l.a.render(s.a.createElement(z,null),document.getElementById("root"))}},[[22,1,2]]]);
//# sourceMappingURL=main.d470b014.chunk.js.map